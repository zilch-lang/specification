\let\oldpart\part
\renewcommand{\partmark}{}
\renewcommand{\part}[1]{\oldpart{#1}\renewcommand{\partmark}{#1}}


\pagestyle{fancy}
\fancyhf{}
\renewcommand{\chaptermark}[1]{\markboth{#1}{#1}}
\fancyhead[L]{\textsc{\partmark}}
\fancyhead[R]{\textsc{\leftmark}}
\makeatletter
\fancyfoot[L]{\textsc{\@title}}
\makeatother
\fancyfoot[R]{\textsc{Page \thepage} of \pageref*{LastPage}}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

\patchcmd{\chapter}{\thispagestyle{plain}}{\thispagestyle{fancy}}{}{}
\patchcmd{\oldpart}{\thispagestyle{plain}}{\thispagestyle{empty}}{}{}


\setlength{\cftpartindent}{0em}
\setlength{\cftchapindent}{2em}
\setlength{\cftsecindent}{4em}
\setlength{\cftsubsecindent}{6em}
\setlength{\cftsubsubsecindent}{8em}



\renewcommand\epigraphflush{flushright}
\renewcommand\epigraphsize{\normalsize}
\setlength\epigraphwidth{0.7\textwidth}


\makeatletter

\@addtoreset{chapter}{part}
\makeatother

\definecolor{mintedbg}{rgb}{.96,.96,.96}

\setminted{
  breaklines=true,
  mathescape=true,
  breaksymbolleft={},
  autogobble=true,
  xleftmargin=\parindent,
  xrightmargin=\parindent,
  frame=single,
  framerule=\fboxrule,
  framesep=1.5\fboxsep,
  style=xcode,
}
\makesavenoteenv{minted}

\BeforeBeginEnvironment{minted}{\begin{minipage}{\textwidth}}
\AfterEndEnvironment{minted}{\end{minipage}}

\def\nstarlexer{lexer/nstar.py:NStarLexer -x}
\def\zilchlexer{lexer/zilch.py:ZilchLexer -x}

\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}

\defglsentryfmt{\glsgenentryfmt
  \ifglsused{\glslabel}{}{$^*$}}

\renewcommand{\glossarysection}[2][\theglstoctitle]{%
 \def\theglstoctitle{#2}%
}

\makeglossaries{}
\input{glossary}

\hypersetup{
  colorlinks=false
}

\graphicspath{{./res/}}

\titleformat{\chapter}[block]{\normalfont\LARGE\bfseries}{\thechapter.}{1em}{}
\titlespacing*{\chapter}{0pt}{-19pt}{19pt}

\definecolor{titlepagecolor}{cmyk}{0,.62,.62,.09}

\addbibresource{main.bib}


\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{Y}[0]{>{\centering\arraybackslash}X}


\usetikzlibrary{arrows, shapes}


\def\nstar{N$^{\star}$}

\setlength{\fboxsep}{2ex}

\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=black,
    anchorcolor=black,
    citecolor=black,
    urlcolor=cyan,
    pdftitle={The magical Zilch book},
    bookmarks=true,
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
